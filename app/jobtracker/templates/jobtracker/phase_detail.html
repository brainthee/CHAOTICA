{% extends "base.html" %}
{% load menu %}{% load static %}

{% block pageTitle %}Phase{% endblock pageTitle %}
{% block head_title %}{{ job }}{% endblock head_title %}


{% block breadcrumbItem %}
<li class="breadcrumb-item text-sm"><a class="opacity-50 text-dark" href="{% url 'job_list' %}">Jobs</a></li>
<li class="breadcrumb-item text-sm"><a class="opacity-50 text-dark" href="{{ job.client.get_absolute_url }}">{{ phase.job.client }}</a></li>
<li class="breadcrumb-item text-sm"><a class="opacity-50 text-dark" href="{{ phase.job.get_absolute_url }}">{{ phase.job.id }}:{{ phase.job.title }}</a></li>
<li class="breadcrumb-item text-sm"><span class="opacity-50 text-dark">Phase</span></li>
<li class="breadcrumb-item text-sm text-dark active" aria-current="page">{{ phase.phase_number }}:{{ phase.title }}</li>
{% endblock breadcrumbItem %}

{% block content_classes %}px-0 {% endblock content_classes %}
{% block breadcrumb_classes %}px-5{% endblock breadcrumb_classes %}

{% block content %}

<div class="mt-0 p-0 text-center">
  {% include 'partials/job/warnings.html' %}
  {% include 'partials/phase/warnings.html' %}
</div>

<div class="row px-5">
  <div class="col-12">
    <div class="row align-items-center justify-content-between g-3 mt-0 mb-0">
      <div class="col-6 col-md-auto">
        <h2 class="mb-2">
          Phase Detail
        </h2>
      </div>

      <div class="col-md-auto">
        <div class="d-flex">
          {% include 'partials/phase/status_buttons.html' %}

          <button class="btn px-3 ms-3 btn-phoenix-secondary" type="button" data-bs-toggle="dropdown" 
            data-boundary="window" aria-haspopup="true" aria-expanded="false" data-bs-reference="parent">
            <span class="fa-solid fa-ellipsis"></span>
          </button>
          {% include 'partials/phase/status_button_menu.html' %}
        </div>
      </div>
    </div>
  </div>
</div>



<div class="row justify-content-between ms-3 me-3 g-3 mt-0 mb-0">
  <div class="col-4">
    <div class="card">
      <div class="card-body pb-0">
        <div class="row align-items-center g-3">
          <div class="col-12 col-sm-auto flex-1">
            <h3 class="fw-bolder mb-2 line-clamp-1">
              {{ phase.phase_id }} - {{ phase.title }}
            </h3>

            <table class="w-auto table-stats table-stats">
              <tbody>
                  <tr><th class="sm"></th><th class="sm"></th><th></th></tr>
                  <tr>
                    <td class="py-1">
                        <div class="d-flex align-items-center">
                          <div class="d-flex bg-info-100 rounded-circle flex-center me-3" style="width:24px; height:24px">
        
                          </div>
                          <p class="fw-bold mb-0">Job</p>
                        </div>
                    </td>
                    <td class="py-1 d-none d-sm-block pe-sm-2">:</td>
                    <td class="py-1">
                        <p class="ps-6 ps-sm-0 fw-semi-bold mb-0">{{ job }}</p>
                    </td>
                  </tr>
                  <tr>
                    <td class="py-1">
                        <div class="d-flex align-items-center">
                          <div class="d-flex bg-info-100 rounded-circle flex-center me-3" style="width:24px; height:24px">
        
                          </div>
                          <p class="fw-bold mb-0">Client</p>
                        </div>
                    </td>
                    <td class="py-1 d-none d-sm-block pe-sm-2">:</td>
                    <td class="py-1">
                        <p class="ps-6 ps-sm-0 fw-semi-bold mb-0">
                          <a href="{{ job.client.get_absolute_url }}">{{ job.client }}</a>
                        </p>
                    </td>
                  </tr>
                  <tr>
                    <td class="py-1">
                        <div class="d-flex align-items-center">
                          <div class="d-flex bg-info-100 rounded-circle flex-center me-3" style="width:24px; height:24px">
        
                          </div>
                          <p class="fw-bold mb-0">Status</p>
                        </div>
                    </td>
                    <td class="py-1 d-none d-sm-block pe-sm-2">:</td>
                    <td class="py-1">
                        <p class="ps-6 ps-sm-0 fw-semi-bold mb-0">
                          {% include 'partials/phase/status_badge.html' %}
                        </p>
                    </td>
                  </tr>
                  <tr>
                    <td class="py-1">
                        <div class="d-flex align-items-center">
                          <div class="d-flex bg-info-100 rounded-circle flex-center me-3" style="width:24px; height:24px">
        
                          </div>
                          <p class="fw-bold mb-0">Service</p>
                        </div>
                    </td>
                    <td class="py-1 d-none d-sm-block pe-sm-2">:</td>
                    <td class="py-1">
                        <p class="ps-6 ps-sm-0 fw-semi-bold mb-0">
                          <a href="{% url 'service_detail' phase.service.slug %}">{{ phase.service }}</a>
                        </p>
                    </td>
                  </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-8">
    <div class="row">
      <div class="col-12 ">
        <div class="card theme-wizard mb-0" data-theme-wizard="data-theme-wizard">
          <div class="card-header px-6 pt-1 pb-0 border-bottom-0">
            {% include 'partials/phase/progress_wizard.html' %}
          </div>
        </div>
      </div>
    </div>
    <div class="row pt-5 align-items-center">
      {% include 'partials/phase/widgets/dates.html' %}
    </div>
  </div>

</div>




<div class="row g-0 mt-3 border-1 border-top bg-light dark__bg-1100 h-100">
  <div class="col-12 col-md-9 px-6 pt-3 border-1 border-end">

    <div class="row mx-1">  
      <ul class="nav nav-underline scrollbar flex-nowrap w-100 pb-1 mb-3" id="sectionNav" role="tablist" style="overflow-y: hidden;">
        <li class="nav-item text-nowrap me-2" role="presentation">
          <a class="nav-link active" id="general-tab" data-bs-toggle="tab" href="#general" role="tab" aria-controls="tab-meeting" aria-selected="true">
            <span class="fa-solid fa-video me-2 tab-icon-color"></span>General
          </a>
        </li>
        <li class="nav-item text-nowrap me-2" role="presentation">
          <a class="nav-link" id="schedule-tab" data-bs-toggle="tab" href="#schedule" role="tab" aria-controls="tab-schedule" aria-selected="false" tabindex="-1">
            <span class="fa-solid fa-clipboard me-2 tab-icon-color"></span>Schedule
          </a>
        </li>
        <li class="nav-item text-nowrap me-2" role="presentation">
          <a class="nav-link" id="deliverables-tab" data-bs-toggle="tab" href="#deliverables" role="tab" aria-controls="tab-deliverables" aria-selected="false" tabindex="-1">
            <span class="fa-solid fa-clipboard me-2 tab-icon-color"></span>Deliverables
          </a>
        </li>
        <li class="nav-item text-nowrap me-2" role="presentation">
          <a class="nav-link" id="feedback-tab" data-bs-toggle="tab" href="#feedback" role="tab" aria-controls="tab-feedback" aria-selected="false" tabindex="-1">
            <span class="fa-solid fa-chart-line me-2 tab-icon-color"></span>Feedback
          </a>
        </li>
        <li class="nav-item text-nowrap me-2" role="presentation">
          <a class="nav-link" id="notes-tab" data-bs-toggle="tab" href="#notes" role="tab" aria-controls="tab-notes" aria-selected="false">
            <span class="fa-solid fa-square-check me-2 tab-icon-color"></span>Notes
          </a>
        </li>
      </ul>

      <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade active show" id="general" role="tabpanel" aria-labelledby="general-tab">
          {% if phase.job.inScoping %}
            {% include 'partials/phase/forms/info.html' %}
          {% else %}
            {% include 'partials/phase/widgets/info.html' %}
          {% endif %}
        </div>
        <div class="tab-pane fade active show" id="schedule" role="tabpanel" aria-labelledby="schedule-tab">
          
        </div>
        <div class="tab-pane fade" id="deliverables" role="tabpanel" aria-labelledby="deliverables-tab">    
          {% if phase.status == 7 %}
          {% include 'partials/phase/forms/deliverable_links.html' %}
          {% else %}
          {% include 'partials/phase/widgets/deliverable_links.html' %}
          {% endif %}
        </div>
        <div class="tab-pane fade" id="feedback" role="tabpanel" aria-labelledby="feedback-tab">    
          {% include 'partials/phase/widgets/feedback.html' %}
        </div>
        <div class="tab-pane fade" id="notes" role="tabpanel" aria-labelledby="notes-tab">
          {% include 'partials/phase/widgets/notes.html' %}
        </div>
      </div>
  
    </div>
  </div>

  <div class="col-12 col-md-3 px-0 border-start-xxl border-300 border-top-0">
    <div class="h-100">
      <div class="bg-light dark__bg-1100 h-100">
        <div class="p-3">
          <h4 class="mb-3">Team</h4>
          {% include 'partials/phase/widgets/team_list.html' %}
        </div>   

        <div class="p-3">
          <h4 class="mb-3">Links</h4>
          {% include 'partials/phase/widgets/links.html' %}
        </div>   

        <div class="p-3">
          <h4 class="mb-3">Recent activity</h4>
          {% include 'partials/phase/widgets/activity.html' %}
        </div>          
      </div>

    </div>
  </div>
</div>

{% endblock content %}

{% block footer_javascript_page %}
<script>

$("#scopePhaseForm").dirty({preventLeaving: true});

</script>
{% endblock footer_javascript_page %}